Я использую тут штуку из [открытого доступа](https://github.com/Valve/fingerprintjs), у этих же ребят есть [коммерческий продукт](https://fpjs.io/), который даёт 99.95% попаданий (там есть похожая демка, рекомендую).

Хрен знает, сработало у вас моё демо или нет, но у меня работает безотказно. Вот так, друзья, и начинают носить шапочку из фольги. 

### Скрипты

Скрипты. Скрипты везде. Скрипты в твоём телефоне, в холодильнике и телевизоре, в вибраторе и духовке, в автоматической оконной роллете и ротационном рекламном баннере, в поезде метро и опять в вибраторе. Они везде. В моём блоге тоже.

Собирайтесь, дети, в круг, дедушка расскажет вам еще немного истории веба.

#### Каталоги

До повальной адаптации поисковиков существовали каталоги. Ну вот открыли вы браузер в 1998 году, куда идти, что делать? Гугла в текущем огромном виде пока нет. Правильно, надо идти в каталоги. Это были модерируемые людьми наборы сайтов, на которых вы могли узнать, где стоит почитать, чо там у хохлов, а где можно поиграть в онлайн-нарды с онлайн-армянами. Каталоги создавались когда-то крутыми интернет-компаниями (олды тут? помните какими гигантами были Yahoo и Rambler?) и ими же модерировались.

Опираться чисто на человеческое мнение невозможно, нужны данные. Как понять, что сайт из каталога реально популярен? Вот чтобы как-то сортировать их по популярности, создатели каталогов придумали счётчики. Для конечного юзера это просто картинка на сайте, но дьявол в деталях:

1. все картинки в вебе скачиваются отдельно от самой страницы, это подключаемые внешние ресурсы.
2. если это внешние ресурсы, то и их скачивание — это некий отдельный запрос.

Конечный юзер видит просто картинку с количеством уникальных посетителей и количеством запросов; а вот каталог, который эту картинку генерирует, видит всё про вас: когда зашли, с какой страницы и, конечно, может вас идентифицировать между разными сайтами. Для такого дела нужно было содействие создателей сайтов, и уже тогда они продали вас с потрохами: им предложили суперпростую аналитику (как раз на уровне просмотра количества посетителей сайта) и предложили позиции повыше в каталоге, если у них популярный сайт, а значит больше посетителей. Всё, вы в жопе, все знают, что у вас есть фетиш на нарды с армянами. Счётчик стоит на сайтах, каталог получает аналитику и автоматически двигает популярные сайты вверх, а непопулярные — вниз.

Важно, впрочем, понять, что картинка — это статичный ресурс. Чтобы скачать картинку нужен запрос, да, но между посещениями одинаковых страниц картинка сохранялась браузером (чтоб не запрашивать еще раз то, что не изменилось), а значит каталог получал инфу даже не обо всех посещениях, не говоря уже о поведении на странице: сколько провёл на странице, как внимательно читал, какие кнопки жал и насколько глубоко по сайту походил. На то это и примитивная картинка, а не скрипт.

#### Поисковики

Потом пришли поисковики, и всё стало внезапно сложнее. Поисковик автоматизированно посещает сайты, скачивает все страницы и осуществляет по ним поиск. Главный вопрос такой: как ему понять, что из 20М страниц по запросу "как совиршить суецыд" он посоветовал самый лучший результат? ~~_Ответ: в идеале пользователь должен пропасть с радаров_~~. В отличие от каталога, он не знает, как себя ведёт пользователь на странице, не знает, как часто тот туда приходит, ему не на что опираться. Тогда Google и пришёл к абсолютно гениальному решению.

Счётчики отпадают — не так-то и много данных они дают. Значит нужен скрипт, и нужно его встроить и максимум сайтов мира. Как без шантажа и паяльника заставить вебмастера (тоже термин из прошлого) встроить в свой сайт сторонний скрипт? Дать что-то сверхинтересное для разработчика. В 2003 году они запустили AdSense — свою площадку для размещаемой контекстной рекламы. Эта площадка позволяла разработчику сайта зарабатывать с просмотров баннеров на своём сайте, достаточно было только разместить один малюсенький скрипт. Маленький шаг для компании, огромный пиздос для человечества.

Вторым шагом был запуск Google Analytics. Помимо денег все разработчики хотели всё больше и больше знать о том, как пользователи ведут себя на сайтах: какие страницы посещают, сколько там проводят времени, как быстро и в каких направлениях отваливаются. Google запустил бесплатный сервис веб-аналитики для всех: "просто вставь мой скрипт, пожалуйста, делай, я хочу обмазаться твоими данными" — томно дышал бигдатой на ухо Google всем разработчикам вокруг, бесцеремонно лапая их за сервера.

Как мы выяснили, скрипты могут знать всё: на что кликаешь, как далеко скроллишь, куда идёшь дальше, что вводишь с клавиатуры и так далее. Что может пойти не так?

Вот мы и подошли к заключительной части ужасного опуса.

## Так кто этот теневой получатель?

Да кто угодно.

Согласно [BuiltWith](https://trends.builtwith.com/analytics/Google-Analytics), из миллиона самых популярных сайтов в мире 68% имеют Google Analytics. Из 10k самых популярных — 88%. У [AdSense](https://trends.builtwith.com/ads/Google-Adsense) пенетрация поменьше — 16% и 33% соответственно. Мы все под колпаком, чудило. Знаю, ваши ладошки вспотели, стало страшно и немного спёрло дыхание. Я хочу, чтобы вы, дорогой читатель, обосрались от страха, поэтому сообщу то, чего вы боитесь больше всего: [93% порносайтов](https://arxiv.org/abs/1907.06520) имеют встроенные скрипты. Google знает, что вы любите то, что в вашей стране осуждается.

Нет-нет, не поймите меня неверно, Google не единственные, кто шалит с данными. [40% топ 10k сайтов имеют трекинговый скрипт Facebook](https://trends.builtwith.com/analytics/Facebook-Pixel).

Automattic (компания, о которой вы вообще никогда не слышали) разработала движок Wordpress, они же предлагают у себя этот сайт разместить; суммарная посещаемость — [полмиллиарда человек в месяц](https://ru.wordpress.com/activity/); а недавно они еще [купили эротический блог-хостинг Tumblr](https://www.theverge.com/2019/8/12/20802639/tumblr-verizon-sold-wordpress-blogging-yahoo-adult-content), [у которых в начале 2019 было 437М посетителей](https://www.theverge.com/2019/3/14/18266013/tumblr-porn-ban-lost-users-down-traffic).

Видите крутую плавающую кнопку с лайками поста? Это может быть скрипт ребят из AddThis, у которых [26% из топ 10k сайтов](https://trends.builtwith.com/widgets/AddThis).

Видите красивые стильные иконки на сайте? Есть вероятность, что на сайте стоит скрипт [FontAwesome](https://fontawesome.com/), [встроенный на 46% тех же сайтов](https://trends.builtwith.com/widgets/Font-Awesome).

У всех этих компаний есть Privacy Policy, в которой написано много разного буллшита, который владельцы сайтов и тем более посетители никогда не читают. Часто там могут быть абсолютно дикие вещи — вроде того, что популярное браузерное расширение Grammarly, которое проверяет орфографию текста, хранит весь вводимый тобой текст вечно, сотрудники могут его читать, а также они как компания получают неэксклюзивное право на хранение, использование и копирование текста. [Я это не придумал](https://twitter.com/sebmck/status/1104132993893904386). Справедливости ради, саппорт Grammarly в треде [постарался объяснить многое](https://twitter.com/Grammarly/status/1104504155991793664), но когда ребята пишут "да, написано так, но _на самом деле_ мы это не делаем", я тихонько хихикаю в кулак и надеваю шапочку из фольги.

Вы всего этого не знаете, не видите, а оно так. Все о вас всё знают.

### Решение

Ты пока не знаешь, почему весь этот сбор данных плох, но, просто поверь, что ты бы хотел его остановить. Он не в твоих интересах.

Я вижу несколько вариантов. Самый простой и пока работающий сейчас — пользоваться [браузером Brave](https://brave.com/). Он по сути идентичен браузеру Chrome, только в нём нет рук Google, это частная компания, во главе, кстати, с одним из создателей языка JavaScript, [Бренданом Эйхом](https://en.wikipedia.org/wiki/Brendan_Eich). Плюсов несколько:

- в браузер встроен хороший блокировщик всего этого описанного дерьма. Это не гарантирует тебе защиту от трекеров, и некоторые данные всё равно будут утекать, но кратно, кратно меньше;
- у браузера открытый исходный код, то есть ты можешь пойти и [почитать код](https://github.com/brave) браузера. В идеале это значит, что в него не получится встроить говна, не обратив на это внимание сообщества.

Молю, не пользуйся расширениями в браузере. Это полная дыра, об этом еще будет пост.

## Как же приложения?

Я осознанно опустил в статье всё, связанное с обычными приложениями на смартфоны. Там всё кратно хуже, приватности просто нет как категории:

1. без специального софта нет способа запретить приложению доступ в сеть целиком или избирательно. Да, на Android есть отдельное разрешение на работу с сетью, но _по субъективному ощущению_ его запрашивают тупо все приложения;
2. без специального софта нет способа посмотреть состав запросов, которые приложение посылает; если установить этот софт ([Charles](https://www.charlesproxy.com/), например), приложение может это узнать (читайте про [HPKP](https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning)), а значит может перестать заниматься грязью. Более того, некоторые приложения отдельно запрещают использование такого софта, прямо отказываются с ним работать;
3. приложения на iOS, Linux, Mac и Windows компилируются в нечитаемый байткод, а приложения на Android видоизменяются до почти что нечитаемого состояния. Узнать, что происходит внутри приложения практически невозможно или безумно сложно;
4. всем приложениям без разбора доступна высокоточная идентификация клиента по рекламному ID. Идентификация, в отличие от сайтов, работает между несколькими приложениями;
5. обе самых популярных платформы принадлежат техногигантам, которые, как мы выяснили выше, не очень заинтересованы в сохранении приватности;
6. приложения имеют возможность в тихом режиме запускаться в фоне без вашего ведома и делать хрен знает что вообще.

Всех этих проблем нет у сайтов. Приложения еще более закрыты и еще больше подтвержены этим загнивающим практикам мониторинга пользователей.

Кое-какой ресерч, несмотря на все сложности, всё же возможен. Есть ребята [42matters](https://42matters.com/app-market-explorer), у них есть бесплатная триалка с возможностью посмотреть, кто использует определённые SDK (читай, те самые скрипты). Например, SDK Firebase (это продукт Google) установлен у 25k приложений на iOS и 1.3M на Android, включая Pinterest, Shazam и Google Maps. SDK Facebook стоит у 81k приложений на iOS и 383k на Android, включая Spotify, Instagram, Lyft и Clash of Clans. SDK Appsflyer, которое помогает точно идентифицировать тебя, стоит у 9k приложений на iOS и 46k на Android (хотя тут у меня сомнения, по субъективному ощущению намного больше).

Данные неточные, но _в том-то и смысл_, что отследить это очень сложно. Проблема с сбором данных имеется и тут, только по этой проблеме еще меньше информации и исследований. Словно бы у кого-то (КХЕ-КХЕ, ГУГЛ, КХА-КХА, ЭППЛ) есть бизнес-интерес вставлять эти палки в колёса.

# Заключение

Наивный мой пирожочек, вы полагаете, что знаете хоть что-нибудь в этом мире? Вы еще даже не у входа в заветную пещеру наслаждения, вы как Тарантино, только пальцы ног пососали. Самое сладенькое будет дальше.

Представь, что это квест. Вы — самый корыстный мудак/мудакесса на планете, и вы проснулись утром, узнав, что контролируете тысячи сайтов и приложений с сотнями миллионов посетителей. Вы хочешь узнать _ну абсолютно всё_, всю грязнющую грязь о них.

Как и, главное, что можно узнать из всего этого? Разберём в следующей статье.
