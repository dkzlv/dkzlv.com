Вот тогда, давным давно, еще в прошлом тысячелетии, возможности правильно и неожиданно оскорбить прохожего в интернете не было, поэтому её решили добавить. JavaScript — это полноценный язык программирования, и на каждой странице любому разработчику много чего доступно. Без вашего разрешения он может посылать запросы на любые сервера в мире, хранить в браузере между открытиями страницы кучу информации, обращаться к акселерометру и гироскопу, следить за всеми нажатиями клавиш на клавиатуре. С разрешением — слать пуши, читать геолокацию, работать с вашей файловой системой ("Проводник" — для бабушек на Windows, Finder — для илиты на Mac), работать с USB-портами, Bluetooth, считывать данные с камеры и микрофона. Словом, кучу всего, смотрите [здесь](https://whatwebcando.today).

Но нас больше всего интересует часть про отправку запросов. Любая страница может обратиться куда угодно. Вот простой пример:

```
Сделать демо с поисковиком фильмов.
```

Когда вы обращаетесь с поисковым запросом с моего блога на сервера IMDB, IMDB получает несколько вещей:

1. поисковый запрос, иллюстрирующий твой херовый вкус в кино;
2. набор кукис, относящийся к сайту IMDB. И тут сразу забавная тема: если кукис нет, IMDB их назначит, даже без твоего логина и пароля, ты не будешь привязан ни к какому пользователю, но будешь привязан к некоему анонимному пользователю, и в дальнейшем IMDB про тебя будет знать; если кукис есть — IMDB тебя узнает.

Да-да. Я слил тебя IMDB. Ты дал согласие? Нет. Ты знал заранее? Нет. Могу я это сделать тихо без каких-либо полей ввода и кнопок "Поиск"? Да нехер делать.

### Скрипты

Скрипты. Скрипты везде. Скрипты в твоём телефоне, в холодильнике и телевизоре, в вибраторе и духовке, в автоматической оконной роллете и ротационном рекламном баннере, в поезде метро и опять в вибраторе. Они везде. В моём блоге тоже.

Немного истории веба.

#### Каталоги

До повальной адаптации поисковиков существовали каталоги. Ну вот открыл ты браузер в 1999 году, куда идти, что делать? Гугла нет. Правильно, надо идти в каталоги. Это были модерируемые людьми наборы сайтов, на которых ты мог узнать, где стоит узнать, чо там у хохлов, а где можно поиграть в онлайн-нарды с онлайн-армянами. Каталоги создавались когда-то крутыми интернет-компаниями (олды тут? помните, Yahoo и Rambler были лидерами?)

Опираться чисто на редактуру невозможно, нужны данные. Как понять, что сайт из каталога реально популярен? Вот чтобы как-то сортировать их по популярности, создатели каталогов придумали предлагать счётчики. Для конечного юзера это просто картинка на сайте, но дьявол в деталях:

1. все картинки в вебе скачиваются отдельно от самой страницы, это подключаемые внешние ресурсы.
2. если это внешние ресурсы, то и их скачивание — это некий отдельный запрос.

Конечный юзер видит просто картинку с количеством уникальных посетителей и количеством заходов; а вот каталог, который эту картинку генерирует, видит всё про тебя с потрохами: когда зашёл, с какой страницы и, конечно, кто ты такой. Уже тогда разработчики продали вас с потрохами, ты в жопе, все знают, что у тебя есть фетиш на нарды с армянами. Получив эту аналитику, каталог смог популярные сайты подвинуть в каталоге выше, а непопулярные — ниже.

Важно, впрочем, понять, что картинка — это статичный ресурс. Чтобы скачать картинку нужен запрос, да, но между посещениями одинаковых страниц картинка кешировалась (ой, прости, забыл, с кем говорю; _картинка сохранялась_), а значит каталог получал инфу даже не обо всех посещениях, не говоря уже о поведении на странице: сколько провёл на странице, как внимательно читал, какие кнопки жал и насколько глубоко по сайту походил. На то это и примитивная картинка, а не скрипт.

#### Поисковики

Потом пришли поисковики, и всё стало внезапно сложнее. Поисковик автоматизированно посещает сайты, скачивает все страницы и осуществляет по ним поиск. Главный вопрос такой: как ему понять, что из 20М страниц по запросу "как совиршить суецыд" он посоветовал самый лучший результат? ~~_Ответ: в идеале пользователь должен пропасть с радаров_~~. В отличие от каталога, он не знает, как себя ведёт пользователь на странице, не знает, как часто тот туда приходит, ему не на что опираться. Тогда Google и пришёл к абсолютно гениальному решению.

Счётчики отпадают — не так-то и много данных они дают. Значит нужен скрипт, и нужно его встроить и максимум сайтов мира. Как без шантажа и паяльника заставить вебмастера (тоже термин из прошлого) встроить в свой сайт сторонний скрипт? Дать что-то сверхинтересное для разработчика. В 2003 году они запустили AdSense — свою площадку для размещаемой контекстной рекламы. Эта площадка позволяла разработчику сайта зарабатывать с просмотров баннеров на своём сайте, достаточно было только разместить один малюсенький скрипт. Маленький шаг для компании, огромный пиздос для человечества.

Вторым шагом был запуск Google Analytics. Помимо денег все разработчики хотели всё больше и больше знать о том, как пользователи ведут себя на сайтах: какие страницы посещают, сколько там проводят времени, как быстро и в каких направлениях отваливаются. Google запустил бесплатный сервис веб-аналитики для всех: "просто встрой скрипт, пожалуйста, не тяни, делай, я хочу обмазаться твоими данными" — томно шептал на ухо Google всем разработчикам вокруг.

Как мы выяснили, скрипты могут знать всё: на что кликаешь, как далеко скроллишь, куда идёшь дальше, что вводишь с клавиатуры и так далее. Что может пойти не так?

## Так кто этот теневой получатель?

Да кто угодно.

Согласно [BuiltWith](https://trends.builtwith.com/analytics/Google-Analytics), из миллиона самых популярных сайтов в мире 68% имеют Google Analytics. Из 10k самых популярных — 88%. У [AdSense](https://trends.builtwith.com/ads/Google-Adsense) пенетрация поменьше — 16% и 33% соответственно. Ты под колпаком, чудило. Знаю, твои ладошки вспотели, стало страшно и немного спёрло дыхание. Я хочу, чтобы ты, дорогой читатель, обосрался, поэтому сообщу тебе то, чего ты боишься больше всего: [93% порносайтов](https://arxiv.org/abs/1907.06520) имеют встроенные скрипты. Google знает, что ты любишь то, что в твоей стране осуждается.

Нет-нет, не пойми меня неверно, Google не единственные, кто шалит с данными. [40% топ 10k сайтов имеют трекинговый скрипт Facebook](https://trends.builtwith.com/analytics/Facebook-Pixel). Automattic (компания, о которой ты вообще никогда не слышал) разработала движок Wordpress, они же предлагают у себя этот сайт разместить; суммарная посещаемость — [полмиллиарда человек в месяц](https://ru.wordpress.com/activity/); а недавно они еще [купили эротический блог-хостинг Tumblr](https://www.theverge.com/2019/8/12/20802639/tumblr-verizon-sold-wordpress-blogging-yahoo-adult-content), [у которых в начале 2019 было 400М посетителей](https://www.theverge.com/2019/3/14/18266013/tumblr-porn-ban-lost-users-down-traffic). Видите крутую плавающую кнопку с лайками поста? Это может быть скрипт ребят из AddThis, у которых [26% из топ 10k сайтов](https://trends.builtwith.com/widgets/AddThis). Видите красивые стильные иконки на сайте? Есть вероятность, что на сайте стоит скрипт [FontAwesome](https://fontawesome.com/), [встроенный на 46% тех же сайтов](https://trends.builtwith.com/widgets/Font-Awesome).

У всех этих компаний есть Privacy Policy, в которой написано много разного буллшита, который ты никогда не читаешь. Часто там могут быть абсолютно дикие вещи — вроде того, что популярное браузерное расширение Grammarly, которое проверяет грамматику текста, хранит весь вводимый тобой текст вечно, их сотрудники могут читать тексты, которые ты пишешь, а также после пользования они получают неэксклюзивное право на хранение, использование и копирование твоего текста. [Я это не придумал](https://twitter.com/sebmck/status/1104132993893904386). Справедливости ради, саппорт Grammarly в треде [постарался объяснить многое](https://twitter.com/Grammarly/status/1104504155991793664), но лично меня это не убедило, хз.

Вы всего этого не знаете, а оно так. Если встраивается скрипт, скрипт может делать всё, что может делать JavaScript. Главным образом, конечно, посылать запросы, рассказывая своему создателю обо всём, что видит.

### Решение

Ты пока не знаешь, почему весь этот сбор данных плох, но, просто поверь, что ты бы хотел его остановить. Он не в твоих интересах.

Я вижу несколько вариантов. Самый простой и пока работающий сейчас — пользоваться [браузером Brave](https://brave.com/). Он по сути идентичен браузеру Chrome, только в нём нет рук Google, это частная компания, во главе, кстати, с одним из создателей языка JavaScript Бренданом Эйхом. Плюсов несколько:

- в браузер встроен хороший блокировщик всего этого описанного дерьма. Это не гарантирует тебе защиту от трекеров, и некоторые данные всё равно будут утекать, но кратно, кратно меньше;
- у браузера открытый исходный код, то есть ты можешь пойти и [почитать код](https://github.com/brave), который заставляет браузер работать. В идеале это значит, что в него не получится встроить говна, не обратив на это внимание сообщества.

Молю, не пользуйся расширениями в браузере. Это полная дыра, об этом еще будет пост.

## Как же приложения?

Я осознанно опустил в статье всё, связанное с обычными приложениями на смартфоны и программами на компьютеры. Они пришли несколько позже, когда махина сбора данных уже работала в полную силу, поэтому эти новые платформы строились изначально с нагибанием приватности в уме. Там всё кратно хуже:

1. без специального софта нет способа запретить приложению доступ в сеть целиком или избирательно;
2. без специального софта нет способа посмотреть, состав запросов, которые приложение посылает; если установить этот софт (Charles, например), приложение может это узнать (читайте про SSL pinning), а значит тесты по определению чистыми не будут;
3. приложения на iOS, Linux, Mac и Windows компилируются в нечитаемый байткод, а приложения на Android видоизменяются до почти что нечитаемого состояния. Узнать, что происходит внутри приложения практически невозможно или безумно сложно;
4. всем приложениям без разбора доступна высокоточная идентификация клиента по рекламному ID. Идентификация, в отличие от сайтов, работает между приложениями;
5. обе самых популярных платформы принадлежат техногигантам, которые, как мы выяснили выше, не очень заинтересованы в сохранении приватности;
6. приложения имеют возможность в тихом режиме запускаться в фоне без вашего ведома и делать хрен знает что вообще.

Всех этих проблем нет у сайтов. Приложения еще более закрыты и еще больше подтвержены этим загнивающим практикам мониторинга пользователей.

```
поискать данные про builtwith, но с SDK: сколько приложений имеет firebase, сколько приложений имеет crashlytics/microsoft сборщик, сколько onesignal, facebook sdk и так далее.

https://apptopia.com/pricing
https://42matters.com/app-market-explorer
```

Вся остальная статья же актуальна и для приложений, но механизмы там чуть-чуть отличаются, зависят от платформы и их имплементация скрыта, поэтому так подробно у меня расписать не выйдет, я не так хорош. Проблема с сбором данных имеется и в приложениях, только по этой проблеме еще меньше информации и исследований. Словно бы у кого-то (КХЕ-КХЕ, ГУГЛ, КХА-КХА, ЭППЛ) есть бизнес-интерес вставлять эти палки в колёса.

# Заключение

Наивный мой пирожочек, ты думаешь, что знаешь хоть что-нибудь в этом мире? Ты еще даже не у входа в заветную пещеру наслаждения, ты как Тарантино, только пальцы ног пососал. Самое сладенькое будет дальше.

Представь, что это квест. Ты — самый корыстный мудак на планете, и ты проснулся утром, узнав, что контролируешь тысячи сайтов и приложений с сотнями миллионов посетителей. Ты хочешь узнать _ну абсолютно всё_, всю грязнющую грязь о них.

Как и, главное, что можно узнать из всего этого? Разберём в следующей статье.
