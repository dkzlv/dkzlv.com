Тяжело быть в IT, потому что все твои школьные друзья вообще не вдупляют, чем ты занимаешься. Программист, продакт-менеджер, QA — чем это всё отличается от починки принтера? (подсказка: за починку принтера не получаешь 300k в секунду)

С обычными людьми об IT и не поговорить, потому что этой индустрией пользуются, но её не понимают. Но есть одна тема, которую можно поднять с любым смертным и которая его заинтересует, которую он поймёт и которая взорвёт ему мозг: приватность данных.

```
Комикс:
все сидят в баре, я лечу, типа "предиктивные алгоритмы, хайлоад, c++ vs rust…" — всем похер;
...
"твои дикпики лежат на серверах facebook" — выплёвывают пиво;
```

> Дисклеймер:
>
> - пост длинный. Но я разбавил его шутейками и картинками, чтобы клиповое мышление не умерло в агонии;
> - если вы из айти — ну штош, считайте, что забрёли в первый класс и изучаете алфавит. Возможно, не узнаете ничего нового; если узнаете — это тревожный звоночек для вашего работодателя.

Как за нами следят? Спасёт ли VPN и режим инкогнито? Может, стоит вообще спаковать манатки и уехать в тайгу жить среди медведей?

# Часть 1: Классификация заболеваний

В каком-то смысле право на частную жизнь консолидирует все остальные права: на голосование, свободу самовыражения, равные возможности и так далее. Достаточно потерять право на частую жизнь и всё, тобi пiзда. Большинство людей влёгкую попадают в ловушку мышления _"Мне нечего скрывать, какое мне дело до приватности?"_. Распространённая ошибка. Беспокоиться надо не о том, что ты хочешь скрыть, а о том, что ты даже не думаешь скрывать.

Тема настолько обширная, что пришлось придумать свою категоризацию. Я долго над этим думал (минуты 3, не меньше) и пришёл к такой мысли: самое важное — это очевидность того, кто хранит данные пользователя, что это за данные и как ими манипулируют. Выходит три переменных: актор, данные, манипуляция. Всего-то трёхмерная матрица — помнишь, я писал, что даже тупой поймёт суть статьи? Не помнишь? Я тоже. Видимо, не писал.

Актор:

1. **непосредственный получатель**. Когда вы отдаёте свой номер телефона для получения очередной скидочной карты, магазин получает ваш номер телефона. Да, первый невозможный инсайд из статьи, спасибо, Даня — не за что, дорогой читатель.
2. **теневой получатель**. Но так ли очевидно, что при получении скидочной карты вы соглашаетесь на передачу и продажу этих персональных данных кому угодно? Хотели бы вы, чтоб Google и Facebook знали, что у вас есть карта постоянного покупателя борделя "Упругий бутон"? А ведь они эту хуйню [несомненно купят](https://www.nytimes.com/2013/03/26/technology/facebook-expands-targeted-advertising-through-outside-data-sources.html). Вы еще даже не скачали с торрентов "Он вам не Димон", а отдел "К" уже пробивает, какую туалетку вы покупаете, чтобы на ней шрифтом Брайля передать угрозы вашей жопе, всё спасибо скидочной карте "Ашана".

Данные:

1. **то, что вы сознательно отдаёте**. Вы открываете очередное приложение, которое добавляет вашей морде ушки няшного кокер-спаниеля. Оно просит доступ к галерее и камере, вы, разумеется, согласие даёте. Что может пойти не так?
2. **то, что вы не хотели бы отдавать**. Ммм, 3896 фотографии, снятые за 3 года. Забавно, что эти фотографии среди прочего содержат [гео-метки](https://ru.wikipedia.org/wiki/EXIF) с точными координатами места кадра — это же, выходит, [точная история всех ваших перемещений за всё время](https://github.com/KrauseFx/detect.location)? Ну и совершенно очевидно, что приложение получает программный доступ не только к тому кадру, который вы выбираете, но и к всем другим, не спрашивая дополнительного разрешения.

Манипуляция:

1. **хранение**. Возвратимся к аналогии с фотографиями: если вы выбираете фотку для добавления пёсьей морды, она может храниться на серверах сервиса добавления пёсьих морд на произвольное время. Ничего необычного.
2. **вычисление**. Но, как я уже сказал, помимо одной загруженной фотки, приложение будет иметь доступ к всей галерее. Так ли очевидно, что по элементарному анализу времени съёмки всех кадров можно найти адрес вашей работы/учёбы и дома? А что всю галерею можно прогнать через [машинный алгоритм поиска порно-изображений](https://yahooeng.tumblr.com/post/151148689421/open-sourcing-a-deep-learning-solution-for), чтоб аккуратненько залить только ваши нудесы на сервера? Надеюсь, собачья морда того стоила.
3. **продажа**. "Если ты не платишь за продукт, ты и есть продукт". Instagram бесплатен только потому, что любой человек в мире может за мизерный бакшишь показать рекламное объявление только своей узкой аудитории. Кто часто путешествует в страны с пляжным отдыхом, или кто любит определённую еду, или у кого высокий доход. Instagram это вычисляет из огромного объёма собранных данных, а рекламодатель может эти сегменты комбинировать как угодно; разумеется, когда вы кликаете на рекламу, рекламодатель точно знает все характеристики, под которые вы подходите. Такие дела.
  ```
  Комикс: примерно и образно объяснить продажу данных: какие бывают сегменты, поведенческие характеристики и пр.
  И добавить чёрный юмор про какого-то очень плохого рекламодателя и то, как он отметает аудиторию по плохим причинам. Например, как ватники покупают рекламу на тех, кто верит в астрологию и прочую муть, чтобы продвигать пропаганду. Типа "эти идиоты хавают любое говно".
  ```
4. **проёб или слив**. Ой, посоны и посонессы, когда до этого дойдём, я специально включу камеру на вашем ноуте, чтобы заснять охуевшее лицо. Пока просто поверьте: данные проёбывают *абсолютно все*, от гаражного стартапа до Google, от районной бухгалтерской конторы до Федеральной Налоговой службы целого государства. От некоторых случаев у меня ходяь мурашки по телу.

Некоторые из пунктов так и просят какого-то объяснения (и оно будет!), потому что у неокрепших умов пользователей почему-то возникает мысль, что Большие Корпорации не такие уж мудацкие и точно желают человечеству добра. Штош, если вы так тоже думаете, разочарование будет болезненным.

# Часть 2: Акторы

Начнём сверху вниз. Комплюктеры связываются между собой по Великой Интернет-Сети, а общаются они с помощью Волшебных Запросов. Поэтому чтобы понять угрозы сперва разберём то, как работает Волшебный Запрос.

Когда вы заходите на чей-то блог, ваш компьютер совершает запрос к другому компьютеру, и получает какой-то ответ. Но запрос не идёт линейно к целевой машине, а проходит через несколько промежуточных пунктов. На каждом из этих промежуточных пунктов нас подстерегают опасности.

```
Комикс:
Объяснение флоу запроса:

девайс -> DNS
девайс -> провайдер -> ДЦ -> сервер
итоговая страница -> ???
```

> Схема суперпростая, её соответствие реальности — где-то 60%, но и вы, если верить британским учёным, [на 60% банан](https://www.getscience.com/biology-explained/how-genetically-related-are-we-bananas), так что интересующиеся могут [почитать матчасть](https://github.com/alex/what-happens-when).

## Девайс → DNS

Машины привыкли между собой адресовать запросы по т.н. ip-адресам — выглядят они как четыре числа, разделённые точками, например `127.0.0.1`. Люди же привыкли пользоваться буквенными, понятными нашему аналоговому мозгу — например, [dkzlv.com](https://dkzlv.com/). Это мы называем доменом.

_Еще хоть один чёрт придёт ко мне в личку с рассказом про ipv6, я за себя не ручаюсь._

Всё это удобство благодаря штуке под названием DNS (Domain Name Server, Домен Имя Сервер, понятно всё?). Думайте об этом как об огромной таблице в Excel, которая переводит домен в ip-адрес. Мой —  `127.0.0.1` ([РКН, баньте, я не против](https://meduza.io/news/2016/12/12/roskomnadzor-popytalsya-zablokirovat-localhost)).

Вот мы и узнали первую течь: DNS. Когда безрукие спецы вашего провайдера что-то настроили и дали вам бумажку со словами "только не потеряйте" (бумажку вы выбросили сразу, конечно же), вот тогда-то вам и настроили DNS-сервера провайдера. "Для скорости" — говорят они. "Небезопасное говно" — читаем мы.

Использование DNS-серверов вашего провайдера означает, что вы будете ходить к ним и узнавать, какой ip-адрес у какого домена. Это как если бы вы у комендатна спрашивали дорогу: спросите туалет — скажут правду, спросите номер комнаты вашего секс-партнёра — пошлют нахуй. Это не только открывает прекрасный мир блокировок неугодных сайтов (об этом в другой раз, мои либерально-ватниковые друзья), это еще сообщает провайдеру о том, что вы точно посещали какой-то сайт.

**Решение**: использовать независимые зарубежные DNS-сервера. Я рекомендую использовать DNS Cloudflare — он бесплатный, быстрый, и они говорят, что ничего о твоих мерзких привычках не сохраняют. [Тут вот подробный гайд](https://developers.cloudflare.com/1.1.1.1/setting-up-1.1.1.1/) по настройке для всех платформ и устройств, инглиш онли, сори.

## Девайс → провайдер → ДЦ → сервер

Есть два типа соединений: защищённое и незащищённое. О незащищённых вам сообщит браузер, если он у вас не древний как говно мамонта. Если он не древний, как [говно чёрного носорога](https://ru.wikipedia.org/wiki/Чёрный_носорог), возможно браузер даже вас настоятельно попросит одуматься и не пользоваться таким сайтом.

Если видите сообщение про незащищённое соединение, лучше вообще закрыть страницу и ничего с ней не делать. Поверьте, с точки зрения информационной безопасности это хуже, чем заниматься незащищённым сексом с партнёром, у которого от гениталий расходятся радиальные красные полосы.

```
Комикс:
визуализировать незащищённое соединение. Например, что-то про вскрытые конверты и правку сообщений от агентов КГБ
```

При незащищённом соединении нет никаких уязвимостей, кроме одной небольшой: любой посредник имеет полный контроль над всем, что вы принимаете или посылаете, то есть это полное отсутствие безопасности. Мобильные операторы, например, [вставляют на незащищённые сайты](https://tjournal.ru/tech/62611-pochemu-megafon-bessovestno-pokazyvaet-reklamu-na-chuzhih-saytah) свою полноэкранную рекламу без ведома владельца сайта.

Так что поговорим про защищённое соединение. Чтобы вы могли блеснуть перед бабушками у подъезда знаниями, дам краткий ликбез в криптографию (нет, с криптовалютами не связано) и работу сети.

Если вы не PhD по криптографии и не запускали из школьной столовки свои ICO, достаточно знать, что существует два типа шифрования: симметричное и ассиметричное. По простому, в симметричном для шифрования и расшифровки используется одинаковый ключ. В ассиметричном одним ключом вы зашифровываете — его часто называют **приватным** или **закрытым** — а вторым ключом расшифровываете — его называют **публичным** или **открытым**. Никто не знает, какая там математика замешана (как никто не знает, почему такие на вид тяжёлые самолёты летят по небу), но некоторые алгоритмы шифрования взломать почти невозможно.

Вот для защищённого соединения используются оба типа шифрования. Чтоб вы не заснули, я оформил эту процедуру в виде пьесы.

> **Действующие лица**:
>
> **Озгюр**: молодой турок, которого женщины мира единогласно решили воздержать от секса.
>
> **Нина**: русская девушка, которую я добавил сюда для полноты картины.
>
> **Телефон Озгюра**: устройство, отправляющее сообщения.
>
> **Pinder**: сервис, где принято писать похабные сообщения.
>
> **Сервер Pinder**: сервер, принимающий сообщения.
>
> **Акт 1**
>
> _Озгюр долго печатает Нине в Pinder_
>
> **Телефон Озгюра** (_обращается к серверу Pinder_): Дарова, брат. Мой ублюдок хочет написать сообщение. Давай сделаем всё по-чистому, защищённо. Я умею в HTTPS.
>
> **Сервер Pinder**: Дарова, брат. Понятно, соболезную. Я тоже в умею в HTTPS. План такой, короче: во-первых, я тебе пришлю мой публичный ключ, и все дальнейшие сообщения ты будешь шифровать им, чтоб нас никто не подслушивал. Во-вторых, пришли мне какую-нибудь в зашифрованном виде белиберду, чтобы я на её основе сделал симметричный ключ. Ведь симметричное шифрование, дорогой читатель, работает намного быстрее ассиметричного.
>
> _Четвертая стена рушится_
>
> _Сервер Pinder присылает публичный ключ_
>
> _Телефон Озгюра и Сервер Pinder жмут руки_
>
> **Телефон Озгюра**: Твой публичный ключ хорош. Лады, вот тебе моя белиберда. Я из этой белиберды сгенерирую себе симметричный ключ. Выглядит он _примерно так_.
>
> _Телефон Озгюра присылает зашифрованную белиберду и примерный вид ключа_
>
> **Сервер Pinder**: Ок, я смог расшифровать, и правда херня какая-то. Окей, тоже сгенерирую симметричный ключ. Готово. Мой ключ выглядит _примерно так же_. Значит всё ок? Я кончил.
>
> **Телефон Озгюра**: я тоже кончил.
>
> _Всё дальнейшее общение Телефон Озгюра и Сервер Pinder шифруют одинаковым симметричным ключом, который в чистом виде по незащищённому каналу не посылался_
>
> **Акт 2**
>
> **Озгюр** (_закончил печатать_): даш писку ебат.
>
> **Конец**

Некоторые детали я для простоты опустил (центры сертификации, хэши симметричного ключа и т.д.). Особо заинтересованные нёрды могут почитать про TLS handshake всё в той же статье [про работу сети](https://github.com/alex/what-happens-when).

```
Комикс: вставить картинку про агента КГБ, который просто говорит "блять"
```

При защищённом соединении все посредники всё равно видят, на какой сервер вы обращаетесь (ip-адрес), но этой информации мало для сколь угодно нормального анализа, поскольку весь информационный поток зашифрован для каждого пользователя индивидуально, потому что симметричный ключ у всех разный. Наверняка есть какие-то сложные и неточные эвристики для определения хотя бы типа контента — например, если ты уже 10 минут что-то качаешь с pornhub.com, скорее всего, провайдер знает, что это схемы для вязания крючком — но о них беспокоиться не стоит, они очень примерные.

**Решение**: помните про ~~незащищённый секс~~ незащищённое соединение, там всё идет чистым текстом: данные карт, контент, адреса, поля формы, фотографии… Увидите плашку — просто закройте сайт. В 2019 (AND RISING) году просто стыдно не уметь в HTTPS, считайте, что вас по умолчанию такие сайты хотят обуть — глядишь, мир станет чуть безопаснее.

Ежели не хочется, чтобы промежуточные цепочки знали даже про ip-адрес (или если хотите, чтобы РКН лососнул тунца с своими всратыми блокировками), тут как раз и поможет VPN. В моей любимой стране [запрещено публиковать инструкции](https://www.vedomosti.ru/technology/news/2017/11/01/740155-vpn-anonimaizeri) к настройке VPN. Но РКН мне, конечно, не указ, поэтому скажу, что [Cloudflare в своём приложении](https://1.1.1.1/) предлагает бесплатный VPN. А там дальше идите к [Tunnelbear](https://www.tunnelbear.com/) (забанено в России, конечно же), работает как часы. Вертите РКН на что там у вас между ног, не важно.

## Итоговая страница → ???

А вот теперь мы подходим к самой страшной части моего опуса. Всё, происходившее до этого момента — это щютки, потому что именно на этой стадии нас ждёт минное поле в четыре слоя. Даже лучшие из нас на этой стадии обсираются на постоянной основе.

Как вы уже могли догадаться, магии в комплюктерах нет. Если вскрыть этот гнойный нарыв, за каждым неудобным и тупым на первый взгляд решением мы всегда найдём добрую и красивую мотивацию. Примерно как было с ядерной энергетикой, все прелести которой жители двух крупных японских городов особо оценили в 1945 году, на 2 ядерных гриба из 5.

За любым общением двух машин стоят запросы. Отправка ваших нудесов незнакомцам в интернете — это тоже общение, даже если это за вас автоматически без вашего ведома делает программа. И с итоговой страницей, которая показывается в браузере, самая большая проблема в том, что она умеет эти запросы тоже отправлять.

### Анатомия запроса

Как мы узнали, всё общение между компьютерами — это запросы. Вот ты пришёл на "корневой путь" — например, https://dkzlv.com/ — и это один запрос. А если хочешь перейти на страницу конкретной записи — например, [https://dkzlv.com/**ru/chastnaya-zhizn-kotoruyu-my-uzhe-poteryali-chast-1-vvodnaya**](https://dkzlv.com/ru/chastnaya-zhizn-kotoruyu-my-uzhe-poteryali-chast-1-vvodnaya) — это уже второй, свой, отдельный запрос.

Раньше запросы связать между собой нельзя было, то есть не было идентификации пользователей. В те бородатые годы ребята поняли, что нужно придумать костыль, который позволит клиенту между запросами [сохранять состояние корзины покупок](https://en.wikipedia.org/wiki/HTTP_cookie#History) в интернет-магазине. Как обычно, благими намерениями вымощена дорога в ад. Тогда и были придуманы те самые cookies, о которых в последние годы нас постоянно предупреждают сайты.

Cookies, кукис, печеньки — это по сути большущая строка текста, которая содержит пары ключ-значение и выглядит примерно так:

```
TOKEN=0d8152ec62c144bdbe9c96e366112aca; FAV_PRON_GENRES=4,8,15,16,23,42; CHECKOUT_STATE=0; 
```

Было решено, что сервер может просить браузер сохранять эту строчку текста в отношении к конкретному ip-адресу, и когда браузер посылает все дальнейшие запросы, он обязуется прикладывать к запросу сохранённые кукисы. Процедура простая:

1. вы вводите логин и пароль на сайте заказа проституток;
2. сервер проверяет, что всё ок, придумывает несуразную и уникальную строчку текста (вроде `7d8921806f9b4d3baec79c489237acfa`), и запоминает, что тот, кто знает эту секретную строчку текста, тот вы;
3. эту строчку сервер просит браузер запомнить в виде кукис;
4. все дальнейшие запросы на этот сайт браузер шлёт с этой строчкой.

Вот и всё, мы имеем однозначную и безошибочную идентификацию, и состояние корзины не сбрасывается между запросами. Проблема решена, да, но шрапнелью зацепило и нашу приватность.

Так в какой момент Google узнаёт о ваших предпочтениях в порно? Сейчас разберёмся — мы переходим к стадии галопирующего роста интернет-рекламы.

### JavaScript и динамизм

На заре интернетов страницы были статичные. Нажатие каждой кнопки или ссылки приводило к полной перезагрузке страницы. Не было никаких анимаций. Не было баннеров. Не было автоматически воспроизводящих музыку плейеров. Не было настолько тяжёлых сайтов, что у тебя взлетал свеженький Macbook Pro. Знаете, прекрасные были времена.

Но ребята придумали добавить динамизм. Динамизм невозможен без какого-нибудь языка программирования, поэтому для браузеров придумали и стандартизовали лучший язык программирования — [~~Cmm~~ ~~CEnvi~~ ~~Mocha~~ ~~LiveScript~~](https://en.wikipedia.org/wiki/JavaScript#Beginnings_at_Netscape) [~~JScript~~](https://en.wikipedia.org/wiki/JScript) [JavaScript](https://en.wikipedia.org/wiki/JavaScript) (потребовалось чуть больше одной попытки, чтобы создать совершенство). JS даёт тот самый динамизм. Что это такое? Например, вот, нажмите на эту кнопку:
